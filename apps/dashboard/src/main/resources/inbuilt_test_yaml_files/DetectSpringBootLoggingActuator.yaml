id: DETECT_SPRING_BOOT_LOGGING_ACTUATOR
info:
  name: Detect Spring Boot Logging Actuator 
  description: Detect Spring Boot Logging Actuator misconfiguration for potential information disclosure vulnerability.
  details: >
      The Detect Spring Boot Logging Actuator test aims to identify misconfigurations in the Spring Boot Logging
      Actuator, which can lead to information disclosure vulnerabilities. By sending a request to the /logfile 
      endpoint, the test checks if the response contains sensitive information such as error logs or log file 
      paths. This misconfiguration falls under the Security Misconfiguration category with a low severity level. 
      Information disclosure through logging can expose sensitive data and aid attackers in understanding the 
      application's behavior, potentially leading to further exploitation or attacks.
  impact: Misconfigured Spring Boot Logging Actuator exposes sensitive information, increasing the risk of information disclosure and potential attacks.
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: DETECT_SPRING_BOOT_LOGGING_ACTUATOR
  severity: LOW
  tags: 
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
      - modify_url: ${urlVar}logfile

validate:
  response_code:
    eq: 200
  response_payload:
    contains_all: 
      - 'springframework.web.HttpRequestMethodNotSupportedException'
      - 'INFO'
