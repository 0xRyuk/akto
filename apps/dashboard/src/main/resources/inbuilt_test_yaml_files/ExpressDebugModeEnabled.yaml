id: EXPRESS_DEBUG_MODE_ENABLED
info:
  name: Express Debug Mode Enabled 
  description: Express debug mode enabled misconfiguration can expose sensitive information, potentially leading to security vulnerabilities.
  details: >
       The Express Debug Mode Enabled misconfiguration occurs when the Express.js framework is 
       configured to run in debug mode, allowing detailed error information to be displayed in 
       responses. This can expose sensitive information, such as file paths, stack traces, and 
       internal implementation details, to potential attackers. By analyzing the debug output, 
       attackers can gain insights into the application's structure and potentially exploit 
       vulnerabilities. This misconfiguration falls under the Security Misconfiguration category and 
       has a low severity level. Disabling debug mode in production environments is crucial to prevent 
       information disclosure and enhance the application's security posture.
  impact: Enabling Express debug mode can expose sensitive information, increasing the risk of security vulnerabilities and potential attacks.
 category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: EXPRESS_DEBUG_MODE_ENABLED
  severity: LOW
  tags: 
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
      - modify_url: ${urlVar}cy8Ku20LH6V6Yc0q0pJX

validate:
  response_code:
    eq: 404
  response_payload:
    contains_all: 
      - "NotFoundError: Not Found"
      - "at Function.handle"
