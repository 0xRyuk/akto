id: ASP_DEBUG_MODE_ENABLED
info:
  name: ASP.NET Debug Mode Enabled 
  description: "ASP.NET debug mode enabled misconfiguration exposes sensitive information, increasing the risk of security vulnerabilities."
  details: >
        The ASP.NET Debug Mode Enabled misconfiguration occurs when an ASP.NET application is configured to run 
        in debug mode, allowing detailed error information to be displayed in responses. This can expose sensitive
         information, including full file paths, database details, and stack traces, to potential attackers. By 
         analyzing the debug output, attackers can gain insights into the application's internals and potentially 
         exploit vulnerabilities. This misconfiguration falls under the Security Misconfiguration category and has 
         a low severity level. Disabling debug mode in production environments is crucial to prevent information 
         disclosure and enhance the application's security posture.
  impact: "Enabling ASP.NET debug mode exposes sensitive information, increasing the risk of security vulnerabilities and potential attacks."
  category:
      name: SM
      shortName: Misconfiguration
      displayName: Security Misconfiguration (SM)
  subCategory: ASP_DEBUG_MODE_ENABLED
  severity: LOW
  tags: 
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"

api_selection_filters:
  response_code:
    gte: 200
    lt: 300
  url:
    extract: urlVar

execute:
  type: single
  requests:
    - req:
      - modify_url: ${urlVar}Foobar-debug.aspx
      - modify_method: DEBUG
      - modify_header:
          Command: stop-debug
      - modify_header:
          Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
      - modify_header:
          Content-Length: 2

validate:
  response_code: 
    eq: 200
  response_payload:
    contains_all: 
      - "OK"
  response_headers:
    for_one:
      key:
        contains_either: Content-Type
      value:
        contains_either: 2
