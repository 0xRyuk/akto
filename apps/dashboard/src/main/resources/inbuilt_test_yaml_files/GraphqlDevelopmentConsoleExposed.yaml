id: GRAPHQL_DEVELOPMENT_CONSOLE_EXPOSED
info:
  name: "Graphql Development Console Exposed"
  description: "Type introspection allowed"
  details: > 
            "cvbgfdhsjakmdjnhfdjnbfhdnjsk sdfgbfvdcsd"
  impact: "bxcnvhncxmjdhfnjsjdhnjsdhefdnjsm hndfjnhdbsnj"
  category:
    name: SM
    shortName: Misconfiguration
    displayName: Security Misconfiguration (SM)
  subCategory: GRAPHQL_DEVELOPMENT_CONSOLE_EXPOSED
  severity: HIGH
  tags:
    - Business logic
    - OWASP top 10
    - HackerOne top 10
  references:
    - "https://www.apollographql.com/blog/graphql/security/why-you-should-disable-graphql-introspection-in-production/"

api_selection_filters:
  url:
    regex: graphql

execute:
  type: single
  requests:
    - req:
      - modify_url:
          regex_replace:
            regex: graphql.*
            replace_with: graphql
      - replace_body: '{ "query": "query { __type(name:\"Query\") { name } }" }'

validate:
  response_payload:
    contains_all: 
      - "data"
      - "__type"